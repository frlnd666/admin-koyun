<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KoYun Admin Dashboard</title>
    <link rel="stylesheet" href="admin-styles.css">
    
    <!-- Cloudinary Upload Widget -->
    <script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="spinner"></div>
        <p>Loading Admin Dashboard...</p>
    </div>

    <!-- App Container -->
    <div id="appContainer" class="app-container" style="display: none;">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h2>‚òï KoYun Admin</h2>
                <button id="closeSidebar" class="close-sidebar">‚úï</button>
            </div>

            <div class="user-info">
                <div class="user-avatar">A</div>
                <div class="user-details">
                    <h3 id="userName">Admin</h3>
                    <span id="userRole">Administrator</span>
                </div>
            </div>

            <nav class="nav-menu">
                <a href="#" class="nav-item active" data-section="dashboard">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7"></rect>
                        <rect x="14" y="3" width="7" height="7"></rect>
                        <rect x="14" y="14" width="7" height="7"></rect>
                        <rect x="3" y="14" width="7" height="7"></rect>
                    </svg>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-section="orders">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="9" cy="21" r="1"></circle>
                        <circle cx="20" cy="21" r="1"></circle>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                    </svg>
                    <span>Orders</span>
                    <span id="pendingBadge" class="badge">0</span>
                </a>
                <a href="#" class="nav-item" data-section="products">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 7h-9"></path>
                        <path d="M14 17H5"></path>
                        <circle cx="17" cy="17" r="3"></circle>
                        <circle cx="7" cy="7" r="3"></circle>
                    </svg>
                    <span>Products</span>
                </a>
                <a href="#" class="nav-item" data-section="analytics">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="20" x2="18" y2="10"></line>
                        <line x1="12" y1="20" x2="12" y2="4"></line>
                        <line x1="6" y1="20" x2="6" y2="14"></line>
                    </svg>
                    <span>Analytics</span>
                </a>
                <a href="#" class="nav-item" data-section="reports">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    <span>Reports</span>
                </a>
                <a href="#" class="nav-item" data-section="settings">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M12 1v6m0 6v6m8.66-15l-3 5.2M6.34 16.8l-3 5.2m14.66 0l-3-5.2M6.34 7.2l-3-5.2"></path>
                    </svg>
                    <span>Settings</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <button id="logoutBtn" class="btn-logout">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    Logout
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <button id="menuToggle" class="menu-toggle">‚ò∞</button>
                    <h1 id="pageTitle">Dashboard Overview</h1>
                </div>
                <div class="header-right">
                    <span id="currentTime" class="current-time"></span>
                    <button id="refreshBtn" class="btn-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="23 4 23 10 17 10"></polyline>
                            <polyline points="1 20 1 14 7 14"></polyline>
                            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                        </svg>
                    </button>
                </div>
            </header>

            <!-- Dashboard Section -->
            <section id="dashboardSection" class="content-section active">
                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #FFF3CD;">‚è≥</div>
                        <div class="stat-details">
                            <span class="stat-label">Pending Today</span>
                            <span class="stat-value" id="dashPending">0</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #D1ECF1;">‚öôÔ∏è</div>
                        <div class="stat-details">
                            <span class="stat-label">Processing</span>
                            <span class="stat-value" id="dashProcessing">0</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #D4EDDA;">‚úì</div>
                        <div class="stat-details">
                            <span class="stat-label">Completed Today</span>
                            <span class="stat-value" id="dashCompleted">0</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #E2D5C7;">üí∞</div>
                        <div class="stat-details">
                            <span class="stat-label">Today Revenue</span>
                            <span class="stat-value" id="dashRevenue">Rp 0</span>
                        </div>
                    </div>
                </div>

                <!-- Recent Orders -->
                <div class="card">
                    <h3>Recent Orders</h3>
                    <div id="recentOrdersList" class="recent-orders"></div>
                </div>
            </section>

            <!-- Orders Section -->
            <section id="ordersSection" class="content-section">
                <div class="section-header">
                    <h2>Orders Management</h2>
                    <div class="date-filter">
                        <select id="dateFilter" class="select-input">
                            <option value="all">All Time</option>
                            <option value="today">Today</option>
                            <option value="yesterday">Yesterday</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="custom">Custom Range</option>
                        </select>
                        <input type="date" id="customDateStart" class="date-input" style="display: none;">
                        <input type="date" id="customDateEnd" class="date-input" style="display: none;">
                    </div>
                </div>

                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #FFF3CD;">‚è≥</div>
                        <div class="stat-details">
                            <span class="stat-label">Pending</span>
                            <span class="stat-value" id="statPending">0</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #D1ECF1;">‚öôÔ∏è</div>
                        <div class="stat-details">
                            <span class="stat-label">Processing</span>
                            <span class="stat-value" id="statProcessing">0</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #D4EDDA;">‚úì</div>
                        <div class="stat-details">
                            <span class="stat-label">Completed</span>
                            <span class="stat-value" id="statCompleted">0</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #E2D5C7;">üí∞</div>
                        <div class="stat-details">
                            <span class="stat-label">Revenue</span>
                            <span class="stat-value" id="statRevenue">Rp 0</span>
                        </div>
                    </div>
                </div>

                <!-- Filter Tabs -->
                <div class="filter-tabs">
                    <button class="tab-btn active" data-filter="all">
                        All <span id="countAll" class="count">0</span>
                    </button>
                    <button class="tab-btn" data-filter="pending">
                        Pending <span id="countPending" class="count">0</span>
                    </button>
                    <button class="tab-btn" data-filter="processing">
                        Processing <span id="countProcessing" class="count">0</span>
                    </button>
                    <button class="tab-btn" data-filter="completed">
                        Completed <span id="countCompleted" class="count">0</span>
                    </button>
                </div>

                <!-- Orders Grid -->
                <div id="ordersGrid" class="orders-grid"></div>
            </section>

            <!-- Products Section -->
            <section id="productsSection" class="content-section">
                <div class="section-header">
                    <h2>Product Management</h2>
                    <button id="addProductBtn" class="btn btn-primary">
                        + Add Product
                    </button>
                </div>

                <div id="productsGrid" class="products-grid"></div>
            </section>

            <!-- Analytics Section -->
            <section id="analyticsSection" class="content-section">
                <h2>Sales Analytics</h2>
                
                <div id="analyticsChart"></div>
                <div id="topProductsList" style="margin-top: 30px;"></div>
                <div id="profitLossCard" style="margin-top: 30px;"></div>
            </section>

            <!-- Reports Section -->
            <section id="reportsSection" class="content-section">
                <div class="section-header">
                    <h2>Export Reports</h2>
                    <div>
                        <select id="reportPeriod" class="select-input">
                            <option value="today">Today</option>
                            <option value="yesterday">Yesterday</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="all">All Time</option>
                        </select>
                        <button id="exportExcel" class="btn btn-success">Excel</button>
                        <button id="exportCSV" class="btn btn-primary">CSV</button>
                        <button id="exportPDF" class="btn btn-danger">PDF</button>
                    </div>
                </div>

                <div class="info-box">
                    <p>üìä Select a period and click one of the export buttons to download your report.</p>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settingsSection" class="content-section">
                <h2>System Settings</h2>
                
                <div class="card">
                    <div class="section-header">
                        <h3>Staff Management</h3>
                        <button id="addStaffBtn" class="btn btn-primary">+ Add Staff</button>
                    </div>
                    <div id="staffGrid" class="staff-grid"></div>
                </div>

                <div class="card" style="margin-top: 30px;">
                    <div class="section-header">
                        <h3>Expense Management</h3>
                        <button id="addExpenseBtn" class="btn btn-primary">+ Add Expense</button>
                    </div>
                    <div id="expensesGrid" class="expenses-grid"></div>
                </div>
            </section>
        </main>
    </div>

    <!-- Product Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="productModalTitle">Add New Product</h2>
                <button onclick="closeProductModal()" class="close-modal">‚úï</button>
            </div>
            <form id="productForm">
                <div class="form-group">
                    <label>Product Name *</label>
                    <input type="text" id="productName" required>
                </div>
                <div class="form-group">
                    <label>Category *</label>
                    <select id="productCategory" required>
                        <option value="">Select Category</option>
                        <option value="coffee">Coffee</option>
                        <option value="non-coffee">Non-Coffee</option>
                        <option value="food">Food</option>
                        <option value="snack">Snack</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Price *</label>
                    <input type="number" id="productPrice" required min="0">
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="productDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Image</label>
                    <button type="button" id="uploadImageBtn" class="btn btn-secondary">
                        üì∑ Upload from Gallery
                    </button>
                    <img id="productImagePreview" style="display: none; width: 100%; max-width: 300px; margin-top: 12px; border-radius: 8px;">
                    <input type="hidden" id="productImage">
                </div>
                <div class="modal-footer">
                    <button type="button" onclick="closeProductModal()" class="btn btn-secondary">Cancel</button>
                    <button type="button" id="saveProductBtn" class="btn btn-primary">Save Product</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Staff Modal -->
    <div id="staffModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Staff</h2>
                <button onclick="closeStaffModal()" class="close-modal">‚úï</button>
            </div>
            <form id="staffForm">
                <div class="form-group">
                    <label>Name *</label>
                    <input type="text" id="staffName" required>
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" id="staffEmail" required>
                </div>
                <div class="form-group">
                    <label>Password *</label>
                    <input type="password" id="staffPassword" minlength="6">
                    <small>Minimum 6 characters (leave empty when editing)</small>
                </div>
                <div class="modal-footer">
                    <button type="button" onclick="closeStaffModal()" class="btn btn-secondary">Cancel</button>
                    <button type="button" id="saveStaffBtn" class="btn btn-primary">Save Staff</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Expense Modal -->
    <div id="expenseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add Expense</h2>
                <button onclick="closeExpenseModal()" class="close-modal">‚úï</button>
            </div>
            <form id="expenseForm">
                <div class="form-group">
                    <label>Category *</label>
                    <select id="expenseCategory" required>
                        <option value="">Select Category</option>
                        <option value="Ingredients">Ingredients</option>
                        <option value="Utilities">Utilities</option>
                        <option value="Salary">Salary</option>
                        <option value="Rent">Rent</option>
                        <option value="Equipment">Equipment</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Amount *</label>
                    <input type="number" id="expenseAmount" required min="0">
                </div>
                <div class="form-group">
                    <label>Date *</label>
                    <input type="date" id="expenseDate" required>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="expenseDescription" rows="3"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" onclick="closeExpenseModal()" class="btn btn-secondary">Cancel</button>
                    <button type="button" id="saveExpenseBtn" class="btn btn-primary">Save Expense</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Image Modal -->
    <div id="imageModal" class="modal" onclick="closeImageModal()">
        <span class="close-modal">‚úï</span>
        <img id="modalImage" class="modal-image" src="" alt="Payment Proof">
    </div>

    <script type="module" src="/js/dashboard-admin.js"></script>
</body>
</html>
